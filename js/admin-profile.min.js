!function(a,b,c){a(c).ready(function(){var c=a("#wsuwp-profile-tabs").tabs(),d=a("#wsuwp-profile-tabs > ul li").length;a(".wsuwp-profile-add-repeatable").on("click","a",function(b){b.preventDefault();var c=a(this).parent(),d=c.siblings(".wp-profile-repeatable").first().clone(),e="name,id,for";d.find("input").val(""),c.before(d),e=e.split(","),a(this).parent().siblings(".wp-profile-repeatable").each(function(b){a(this).find("input, label").each(function(){for(var c=0;c<e.length;c++)void 0!==a(this).attr(e[c])&&a(this).attr(e[c],a(this).attr(e[c]).replace("0",b))})})}),a("#post-body").on("click",".wsuwp-profile-upload-link",function(c){c.preventDefault();var d,e,f=a(this).parents(".upload-set-wrapper"),g=f.find(".wsuwp-profile-upload"),h=f.find(".wsuwp-profile-upload-link"),i=f.find(".wsuwp-profile-remove-link");d=b.wp.media.frames.file_frame=b.wp.media({title:"Choose "+h.attr("data-type"),button:{text:"Choose "+h.attr("data-type")},multiple:!1}),d.on("select",function(){e=d.state().get("selection").first().toJSON(),g.val(e.id),"Photo"===h.attr("data-type")?e.sizes.hasOwnProperty("thumbnail")?h.html("<img src='"+e.sizes.thumbnail.url+"' />"):(h.addClass("small-image-notice"),h.html("<img src='"+e.url+"' /><span class='description'>This image is smaller than the recommended ___Ã—___ pixel minimum.<br />Please consider uploading a larger image.</span>")):"File"===h.attr("data-type")&&h.html("<img src='http://"+location.host+"/wp-includes/images/media/document.png' />"),0===i.length&&h.after("<p class='hide-if-no-js'><a href='#'' class='wsuwp-profile-remove-link'>Remove "+h.attr("title")+"</a></p>")}),d.open()}),a("#post-body").on("click",".wsuwp-profile-remove-link",function(b){b.preventDefault();var c=a(this).parents(".upload-set-wrapper").find(".wsuwp-profile-upload"),d=a(this).parents(".upload-set-wrapper").find(".wsuwp-profile-upload-link");c.val(""),d.removeClass("small-image-notice"),d.html("Set "+d.attr("title")),a(this).parent(".hide-if-no-js").remove()}),a("#load-ad-data").on("click",function(){var c=a("#_wsuwp_profile_ad_name_first"),d=a("#_wsuwp_profile_ad_name_last"),e=a("#_wsuwp_profile_ad_title"),f=a("#_wsuwp_profile_ad_office"),g=a("#_wsuwp_profile_ad_address"),h=a("#_wsuwp_profile_ad_phone"),i=a("#_wsuwp_profile_ad_email"),j=a("#confirm-ad-hash"),k=a("#confirm-ad-data"),l={action:"wsu_people_get_data_by_nid",_ajax_nonce:b.wsupeople_nid_nonce,network_id:a("#_wsuwp_profile_ad_nid").val()};a.post(b.ajaxurl,l,function(a){a.success&&(c.html(a.data.given_name),d.html(a.data.surname),e.html(a.data.title),f.html(a.data.office),g.html(a.data.street_address),h.html(a.data.telephone_number),i.html(a.data.email),j.val(a.data.confirm_ad_hash),k.removeClass("profile-hide-button"))})}),a("#confirm-ad-data").on("click",function(){var c={action:"wsu_people_confirm_nid_data",_ajax_nonce:b.wsupeople_nid_nonce,network_id:a("#_wsuwp_profile_ad_nid").val(),confirm_ad_hash:a("#confirm-ad-hash").val(),post_id:a("#post_ID").val()},d=a("#title");a.post(b.ajaxurl,c,function(b){b.success&&(""===d.val()&&(d.focus(),d.val(a("#_wsuwp_profile_ad_name_first").html()+" "+a("#_wsuwp_profile_ad_name_last").html())),a("#_wsuwp_profile_ad_nid").attr("readonly",!0),a(".load-ad-container .description").html("The WSU Network ID used to populate this profile's data from Active Directory."),a("#load-ad-data").addClass("profile-hide-button"),a("#confirm-ad-data").addClass("profile-hide-button"),a("#publish").removeClass("profile-hide-button"))})}),a("#add-bio").on("click",function(b){if(b.preventDefault(),d<6){var e=a("#wsuwp-profile-bio-template").clone();a(".wsuwp-profile-bio-tab").last().after("\n<li class='wsuwp-profile-tab wsuwp-profile-bio-tab'><a href='#wsuwp_profile_"+d+"_bio' class='nav-tab'>New Biography</a></li>"),e.attr("id","wsuwp_profile_"+d+"_bio"),a("#wsuwp-profile-bio-template").before(e),c.tabs("refresh");var f=a("a[href='#wsuwp_profile_"+d+"_bio']").parent("li").index();a("#wsuwp-profile-tabs").tabs("option","active",f),d++,6===d&&a("#add-bio").parent("li").remove()}}),a(".wsuwp-profile-bio-type").live("change",function(){var d=a(this).val(),e="_"+d,f=a(this).find("option:selected").text(),g=a(this).parents(".wsuwp-profile-panel"),h=a("a[href='#"+g.attr("id")+"']"),i=g.find(".wsuwp-profile-bio-details-container"),j=g.find(".wsuwp-profile-new-bio"),k=g.find(".wsuwp-profile-bio-photo");a(this).attr("id",d+"_type_select"),h.attr("href","#"+d).html(f+" Biography"),g.attr("id",d),c.tabs("refresh"),j.attr("id",e).attr("name",e),b.tinyMCE.execCommand("mceAddEditor",!1,e),k.attr("name",d+"_photo"),i.show("slow"),a(this).parent("p").remove(),a(".wsuwp-profile-bio-type option[value="+d+"]").remove()}),a("#add-cv").on("click",function(){a(this).parent("li").remove(),a(".wsuwp-profile-tab").last().after("\n<li class='wsuwp-profile-tab'><a href='#wsuwp-profile-cv' class='nav-tab'>C.V.</a></li>"),c.tabs("refresh");var b=a("a[href='#wsuwp-profile-cv']").parent("li").index();a("#wsuwp-profile-tabs").tabs("option","active",b)})})}(jQuery,window,document);