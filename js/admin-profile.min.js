!function(a,b,c){a(c).ready(function(){a("#wsuwp-profile-tabs").tabs({active:0}),a(".wsuwp-profile-add-repeatable").on("click","a",function(b){b.preventDefault();var c=a(this).parent(),d=c.siblings(".wp-profile-repeatable").first().clone(),e="name,id,for";d.find("input").val(""),c.before(d),e=e.split(","),a(this).parent().siblings(".wp-profile-repeatable").each(function(b){a(this).find("input, label").each(function(){for(var c=0;c<e.length;c++)void 0!==a(this).attr(e[c])&&a(this).attr(e[c],a(this).attr(e[c]).replace("0",b))})})}),a("#load-ad-data").on("click",function(){var c=a("#_wsuwp_profile_ad_name_first"),d=a("#_wsuwp_profile_ad_name_last"),e=a("#_wsuwp_profile_ad_title"),f=a("#_wsuwp_profile_ad_office"),g=a("#_wsuwp_profile_ad_address"),h=a("#_wsuwp_profile_ad_phone"),i=a("#_wsuwp_profile_ad_email"),j=a("#confirm-ad-hash"),k=a("#confirm-ad-data"),l={action:"wsu_people_get_data_by_nid",_ajax_nonce:b.wsupeople.nid_nonce,network_id:a("#_wsuwp_profile_ad_nid").val()};a.post(b.ajaxurl,l,function(a){a.success&&(c.html(a.data.given_name),d.html(a.data.surname),e.html(a.data.title),f.html(a.data.office),g.html(a.data.street_address),h.html(a.data.telephone_number),i.html(a.data.email),j.val(a.data.confirm_ad_hash),k.removeClass("profile-hide-button"))})}),a("#confirm-ad-data").on("click",function(){var c={action:"wsu_people_confirm_nid_data",_ajax_nonce:b.wsupeople_nid_nonce,network_id:a("#_wsuwp_profile_ad_nid").val(),confirm_ad_hash:a("#confirm-ad-hash").val(),post_id:a("#post_ID").val()},d=a("#title");a.post(b.ajaxurl,c,function(b){b.success&&(""===d.val()&&(d.focus(),d.val(a("#_wsuwp_profile_ad_name_first").html()+" "+a("#_wsuwp_profile_ad_name_last").html())),a("#_wsuwp_profile_ad_nid").attr("readonly",!0),a(".load-ad-container .description").html("The WSU Network ID used to populate this profile's data from Active Directory."),a("#load-ad-data").addClass("profile-hide-button"),a("#confirm-ad-data").addClass("profile-hide-button"),a("#publish").removeClass("profile-hide-button"))})});var c,d,e=a(".wsuwp-profile-add-photo"),f=a(".wsuwp-profile-photo-collection"),g=a(".wsuwp-profile-photo-count"),h=a(".wsuwp-profile-photo-controls-tooltip");e.on("click",function(d){return d.preventDefault(),c?void c.open():(c=b.wp.media({title:"Select or Upload Your Photos",multiple:!0,library:{type:"image",uploadedTo:b.wsupeople.post_id},button:{text:"Use photo(s)"}}),c.on("select",function(){var b=c.state().get("selection"),d=_.template(a("#photo-template").html()),e=[];a(".wsuwp-profile-photo-id").each(function(){e.push(parseInt(a(this).val()))}),a.each(b.models,function(b,c){var h=Number(g.val())+b,i=c.toJSON(),j=i.sizes.hasOwnProperty("thumbnail"),k=j?i.sizes.thumbnail.url:i.url,l=j?i.sizes.thumbnail.width:i.width,m=j?i.sizes.thumbnail.height:i.height;-1===a.inArray(i.id,e)&&f.append(d({src:k,width:l,height:m,count:h,id:i.id,alt:i.alt,url:i.url,title:i.title,full_width:i.width,full_height:i.height}))}),g.val(f.find(".wsuwp-profile-photo-wrapper").length)}),void c.open())}),a("html").click(function(b){a(b.target).hasClass("wsuwp-profile-photo")?(a(b.target).next(".wsuwp-profile-photo-controls").show(),a(b.target).closest(".wsuwp-profile-photo-wrapper").siblings(".wsuwp-profile-photo-wrapper").find(".wsuwp-profile-photo-controls").hide()):a(".wsuwp-profile-photo-controls").hide()}),f.on("mouseover",".wsuwp-profile-photo-controls button",function(){var a=this.getAttribute("aria-label"),b=this.getBoundingClientRect(),c=f[0].getBoundingClientRect();h.find(".wsuwp-profile-photo-controls-tooltip-inner").html(a),h.css({top:b.bottom-c.top+"px",left:b.right-c.left-h.width()/2-6+"px"}).show()}),f.on("mouseleave",".wsuwp-profile-photo-controls button",function(){h.hide()}),f.on("click",".wsuwp-profile-photo-edit",function(c){c.preventDefault(),h.hide();var e=a(this).closest(".wsuwp-profile-photo-wrapper").find("img"),f={attachment_id:e.data("id"),size:"full",caption:"",align:"none",extraClasses:"",link:!1,title:e.attr("title"),url:e.data("url"),alt:e.attr("alt"),width:e.data("width"),height:e.data("height")};return d?void d.open():(b.wp.media.events.trigger("editor:image-edit",{metadata:f,image:e}),d=b.wp.media({frame:"image",state:"image-details",metadata:f}),d.on("close",function(){var a=d.state().image.attributes;e.attr("title",a.title),e.attr("alt",a.alt),e.data("width",a.width),e.data("height",a.height)}),void d.open())}),f.on("click",".wsuwp-profile-photo-remove",function(b){b.preventDefault(),h.hide(),a(this).closest(".wsuwp-profile-photo-wrapper").remove();for(var c=a(".wsuwp-profile-photo-id"),d=0;d<c.length;d++)a(c[d]).attr("name","photos["+d+"]");g.val(c.length)})})}(jQuery,window,document);