!function(a,b,c){a(c).ready(function(){a("#wsuwp-profile-tabs").tabs({active:0});var c=_.template(a(".wsuwp-profile-repeatable-field-template").html());a(".wsuwp-profile-add-repeatable").on("click","a",function(b){b.preventDefault(),a(this).closest("p").before(c({label:a(this).data("label"),name:a(this).data("name")}))}),a(".wsuwp-profile-repeatable-field").on("click",".wsuwp-profile-remove-repeatable-field",function(b){b.preventDefault(),a(this).closest("p").remove()});var d=a("#_wsuwp_profile_ad_nid"),e=a(".profile-card-data"),f=a("#_wsuwp_profile_ad_name_first"),g=a("#_wsuwp_profile_ad_name_last"),h=a("#_wsuwp_profile_ad_title"),i=a("#_wsuwp_profile_ad_office"),j=a("#_wsuwp_profile_ad_address"),k=a("#_wsuwp_profile_ad_phone"),l=a("#_wsuwp_profile_ad_email"),m=a("#confirm-ad-hash"),n=a("#load-ad-data"),o=a("#confirm-ad-data"),p=a("#refresh-ad-data"),q=a("#undo-ad-data-refresh");a("#load-ad-data, #refresh-ad-data").on("click",function(c){a(c.target).is("#refresh-ad-data")&&e.each(function(){a(this).data("original",a(this).html())});var n={action:"wsu_people_get_data_by_nid",_ajax_nonce:b.wsupeople.nid_nonce,network_id:d.val()};a.post(b.ajaxurl,n,function(a){a.success&&(f.html(a.data.given_name),g.html(a.data.surname),h.html(a.data.title),i.html(a.data.office),j.html(a.data.street_address),k.html(a.data.telephone_number),l.html(a.data.email),m.val(a.data.confirm_ad_hash),o.removeClass("profile-hide-button"),q.removeClass("profile-hide-button"),p.addClass("profile-hide-button"))})}),a("#confirm-ad-data").on("click",function(){var c={action:"wsu_people_confirm_nid_data",_ajax_nonce:b.wsupeople.nid_nonce,network_id:d.val(),confirm_ad_hash:m.val(),post_id:a("#post_ID").val()},e=a("#title"),f=a(".load-ad-container .description"),g=a("#publish");a.post(b.ajaxurl,c,function(b){b.success&&(""===e.val()&&(e.focus(),e.val(a("#_wsuwp_profile_ad_name_first").html()+" "+a("#_wsuwp_profile_ad_name_last").html())),d.attr("readonly",!0),f.html("The WSU Network ID used to populate this profile's data from Active Directory."),n.addClass("profile-hide-button"),o.addClass("profile-hide-button"),g.removeClass("profile-hide-button"),q.addClass("profile-hide-button"))})}),q.on("click",function(){e.each(function(){a(this).html(a(this).data("original"))}),o.addClass("profile-hide-button"),q.addClass("profile-hide-button"),p.removeClass("profile-hide-button")});var r,s,t=a(".wsuwp-profile-add-photo"),u=a(".wsuwp-profile-photo-collection"),v=a(".wsuwp-profile-photo-controls-tooltip");t.on("click",function(c){return c.preventDefault(),r?void r.open():(r=b.wp.media({title:"Select or Upload Your Photos",multiple:!0,library:{type:"image",uploadedTo:b.wsupeople.post_id},button:{text:"Use photo(s)"}}),r.on("select",function(){var b=r.state().get("selection"),c=_.template(a("#photo-template").html()),d=[];a(".wsuwp-profile-photo-id").each(function(){d.push(parseInt(a(this).val()))}),a.each(b.models,function(b,e){var f=e.toJSON(),g=f.sizes.hasOwnProperty("thumbnail"),h=g?f.sizes.thumbnail.url:f.url,i=g?f.sizes.thumbnail.width:f.width,j=g?f.sizes.thumbnail.height:f.height;-1===a.inArray(f.id,d)&&u.append(c({src:h,width:i,height:j,id:f.id,alt:f.alt,url:f.url,title:f.title,full_width:f.width,full_height:f.height}))})}),void r.open())}),a("html").click(function(b){a(b.target).hasClass("wsuwp-profile-photo")?(a(b.target).next(".wsuwp-profile-photo-controls").show(),a(b.target).closest(".wsuwp-profile-photo-wrapper").siblings(".wsuwp-profile-photo-wrapper").find(".wsuwp-profile-photo-controls").hide()):a(".wsuwp-profile-photo-controls").hide()}),u.on("mouseover",".wsuwp-profile-photo-controls button",function(){var a=this.getAttribute("aria-label"),b=this.getBoundingClientRect(),c=u[0].getBoundingClientRect();v.find(".wsuwp-profile-photo-controls-tooltip-inner").html(a),v.css({top:b.bottom-c.top+"px",left:b.right-c.left-v.width()/2-6+"px"}).show()}),u.on("mouseleave",".wsuwp-profile-photo-controls button",function(){v.hide()}),u.on("click",".wsuwp-profile-photo-edit",function(c){c.preventDefault(),v.hide();var d=a(this).closest(".wsuwp-profile-photo-wrapper").find("img"),e={attachment_id:d.data("id"),size:"full",caption:"",align:"none",extraClasses:"",link:!1,title:d.attr("title"),url:d.data("url"),alt:d.attr("alt"),width:d.data("width"),height:d.data("height")};return s?void s.open():(b.wp.media.events.trigger("editor:image-edit",{metadata:e,image:d}),s=b.wp.media({frame:"image",state:"image-details",metadata:e}),s.on("close",function(){var a=s.state().image.attributes;d.attr("title",a.title),d.attr("alt",a.alt),d.data("width",a.width),d.data("height",a.height)}),void s.open())}),u.on("click",".wsuwp-profile-photo-remove",function(b){b.preventDefault(),v.hide(),a(this).closest(".wsuwp-profile-photo-wrapper").remove()})})}(jQuery,window,document);