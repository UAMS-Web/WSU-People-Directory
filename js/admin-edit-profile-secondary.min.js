var wsuwp=wsuwp||{};wsuwp.people=wsuwp.people||{},function(a,b,c,d){d.people.rest_response_complete=!1,d.people.titles="",d.people.degrees="",d.people.bio_content={content:"",_wsuwp_profile_bio_unit:"",_wsuwp_profile_bio_university:""},d.people.populate_editor=function(a){if(!1===d.people.rest_response_complete)return void setTimeout(d.people.populate_editor.bind(null,a),200);b.tinymce.get(a.id).setContent(d.people.bio_content[a.id])},d.people.populate_person_from_people_directory=function(a){var c=jQuery,e=_.template(c(".wsuwp-profile-repeatable-field-template").html()),f=c(".wsuwp-profile-titles .wsuwp-profile-add-repeatable"),g=f.find("a").data("label"),h=f.find("a").data("name"),i=c(".wsuwp-profile-degrees .wsuwp-profile-add-repeatable"),j=i.find("a").data("label"),k=i.find("a").data("name");c("#_wsuwp_profile_post_id").val(a.id),c("#title").focus().val(a.title.rendered).data("original",a.title.rendered),c("#_wsuwp_profile_ad_name_first").html(a.first_name),c("#_wsuwp_profile_ad_name_last").html(a.last_name),c("#_wsuwp_profile_ad_title").html(a.position_title),c("#_wsuwp_profile_ad_office").html(a.office),c("#_wsuwp_profile_ad_address").html(a.address),c("#_wsuwp_profile_ad_phone").html(a.phone),c("#_wsuwp_profile_ad_email").html(a.email),c("#_wsuwp_profile_alt_office").val(a.office_alt).data("original",a.office_alt),c("#_wsuwp_profile_alt_phone").val(a.phone_alt).data("original",a.phone_alt),c("#_wsuwp_profile_alt_email").val(a.email_alt).data("original",a.email_alt),c("#_wsuwp_profile_website").val(a.website).data("original",a.website),d.people.bio_content.content=a.content.rendered,d.people.bio_content._wsuwp_profile_bio_unit=a.bio_unit,d.people.bio_content._wsuwp_profile_bio_university=a.bio_university;var l=c("#bio_unit .readonly"),m=c("#bio_university .readonly");if(0!==l.length&&l.html(d.people.bio_content._wsuwp_profile_bio_unit),0!==m&&m.html(d.people.bio_content._wsuwp_profile_bio_university),d.people.rest_response_complete=!0,c.each(a.working_titles,function(a,b){var d=c("[name='_wsuwp_profile_title[]']")[a];d?c(d).val(b):f.before(e({label:g,name:h,value:b}))}),d.people.titles=a.working_titles,""!==c(".use-title").val()){var n=c(".use-title").val().split(" ");c.each(n,function(a,b){c(".wsuwp-profile-titles p").eq(b).addClass("selected").find(".screen-reader-text").text("Deselect")})}c.each(a.degree,function(a,b){var d=c("[name='_wsuwp_profile_degree[]']")[a];d?c(d).val(b):i.before(e({label:j,name:k,value:b}))}),d.people.degrees=a.degree,a._embedded&&0!==a._embedded["wp:photos"]&&c.each(a._embedded["wp:photos"],function(a,b){d.people.populate_photos(b)}),a._embedded&&a._embedded["wp:featuredmedia"]&&0!==a._embedded["wp:featuredmedia"]&&d.people.populate_photos(a._embedded["wp:featuredmedia"][0]),""!==c(".use-photo").val()?c(".wsuwp-profile-photo-wrapper").eq(c(".use-photo").val()).addClass("selected").find(".wsuwp-profile-photo-select").attr("aria-label","Deselect"):c(".wsuwp-profile-photo-wrapper").eq(0).addClass("selected").find(".wsuwp-profile-photo-select").attr("aria-label","Deselect"),a._embedded&&a._embedded["wp:term"]&&0!==a._embedded["wp:term"]&&(c.each(a._embedded["wp:term"],function(a,b){b&&c.each(b,function(a,b){"post_tag"===b.taxonomy?c("#new-tag-post_tag").val(function(a,c){return c+b.name+", "}):c("#"+b.taxonomy+"-all").find(".selectit:contains('"+b.name+"')").find("input[type='checkbox']").prop("checked",!0)})}),c(".tagadd").trigger("click"),c("#title").focus()),c.ajax({url:b.wsuwp_people_edit_profile_secondary.rest_url+"/"+a.id,type:"POST",beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",b.wsuwp_people_edit_profile_secondary.nonce),a.setRequestHeader("X-WSUWP-UID",b.wsuwp_people_edit_profile_secondary.uid)},error:function(){c("#wsuwp_profile_additional_info input").prop("disabled",!0),c(".wsuwp-profile-button.remove").prop("disabled",!0),c("#new-tag-post_tag").prop("disabled",!0),c(".tabs-panel input").prop("disabled",!0),c(".wsuwp-profile-add-photo").prop("disabled",!0),c(".wsuwp-profile-photo-remove").prop("disabled",!0),b.tinymce.get("content").setMode("readonly"),0===l.length&&b.tinymce.get("_wsuwp_profile_bio_unit").setMode("readonly"),0===m.length&&b.tinymce.get("_wsuwp_profile_bio_university").setMode("readonly")}})},d.people.populate_photos=function(a){var b=jQuery,c=_.template(b("#photo-template").html()),d=a.media_details,e=d.sizes.thumbnail,f=e?d.sizes.thumbnail.source_url:a.source_url,g=e?d.sizes.thumbnail.width:d.width,h=e?d.sizes.thumbnail.height:d.height;-1===b.inArray(a.id,existing_photos())&&b(".wsuwp-profile-photo-collection").append(c({src:f,width:g,height:h,id:a.id,alt:a.alt,url:a.source_url,title:a.title.rendered,full_width:d.width,full_height:d.height}))},a(c).ready(function(){var c=a("#_wsuwp_profile_ad_nid"),e=a("#_wsuwp_profile_post_id").val();b.wsuwp_people_edit_profile_secondary.load_data&&a.ajax({url:b.wsuwp_people_edit_profile_secondary.rest_url,data:{_embed:!0,wsu_nid:c.val()}}).done(function(a){0!==a.length&&d.people.populate_person_from_people_directory(a[0])}),a(".wsuwp-profile-about-tabs").on("click",".select",function(){var b=a(this).closest("li"),c=a(".use-bio");b.toggleClass("selected"),b.hasClass("selected")?(c.val(b.data("bio")),b.find(".screen-reader-text").text("Deselect"),b.siblings().removeClass("selected").find(".screen-reader-text").text("Select")):(c.val(""),b.find(".screen-reader-text").text("Select"))}),a(".wsuwp-profile-titles").on("click",".select",function(){var b=a(this).closest("p");b.toggleClass("selected");var c=a(".wsuwp-profile-titles .selected").map(function(){return a(this).index()}).get();a(".use-title").val(c.join(" ")),b.hasClass("selected")?b.find(".screen-reader-text").text("Deselect"):b.find(".screen-reader-text").text("Select")}),a(".wsuwp-profile-photo-collection").on("click",".wsuwp-profile-photo-select",function(){var b=a(this),c=b.closest(".wsuwp-profile-photo-wrapper"),d=a(".use-photo");c.toggleClass("selected").siblings().removeClass("selected"),c.hasClass("selected")?(d.val(a(".wsuwp-profile-photo-wrapper").index(c)),b.attr("aria-label","Deselect"),c.siblings().removeClass("selected").find(".wsuwp-profile-photo-select").attr("aria-label","Select")):(d.val(""),b.attr("aria-label","Select"))}),a("#publish").on("click",function(){var c={},f=a("#title"),g=a("#_wsuwp_profile_alt_office"),h=a("#_wsuwp_profile_alt_phone"),i=a("#_wsuwp_profile_alt_email"),j=a("#_wsuwp_profile_website"),k=a("[name='_wsuwp_profile_title[]']"),l=a("[name='_wsuwp_profile_degree[]']"),m=b.tinymce.get("content"),n=b.tinymce.get("_wsuwp_profile_bio_unit"),o=b.tinymce.get("_wsuwp_profile_bio_university");if(f.val()!==f.data("original")&&(c.title=f.val()),g.val()!==g.data("original")&&(c.office_alt=g.val()),h.val()!==h.data("original")&&(c.phone_alt=h.val()),i.val()!==i.data("original")&&(c.email_alt=i.val()),j.val()!==j.data("original")&&(c.website=j.val()),k){var p=k.map(function(){return a(this).val()}).get();p.join(",")!==d.people.titles.join(",")&&(c.working_titles=p)}if(l){var q=l.map(function(){return a(this).val()}).get();q.join(",")!==d.people.degrees.join(",")&&(c.degree=q)}m&&m.getContent()!==d.people.bio_content.content&&(c.content=m.getContent()),n&&n.getContent()!==d.people.bio_content._wsuwp_profile_bio_unit&&(c.bio_unit=n.getContent()),o&&o.getContent()!==d.people.bio_content._wsuwp_profile_bio_university&&(c.bio_university=o.getContent()),a.isEmptyObject(c)||a.ajax({url:b.wsuwp_people_edit_profile_secondary.rest_url+"/"+e,method:"POST",beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",b.wsuwp_people_edit_profile_secondary.nonce),a.setRequestHeader("X-WSUWP-UID",b.wsuwp_people_edit_profile_secondary.uid)},data:c})})})}(jQuery,window,document,wsuwp);