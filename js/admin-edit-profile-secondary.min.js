function populate_from_people_directory(a){var b=jQuery,c=_.template(b(".wsuwp-profile-repeatable-field-template").html()),d=b(".wsuwp-profile-titles .wsuwp-profile-add-repeatable"),e=d.find("a").data("label"),f=d.find("a").data("name"),g=b(".wsuwp-profile-degrees .wsuwp-profile-add-repeatable"),h=g.find("a").data("label"),i=g.find("a").data("name"),j=window.tinymce.get("_wsuwp_profile_bio_unit"),k=window.tinymce.get("_wsuwp_profile_bio_university");if(b("#_wsuwp_profile_post_id").val(a.id),b("#title").focus().val(a.title.rendered).data("original",a.title.rendered),b("#_wsuwp_profile_ad_name_first").html(a.first_name),b("#_wsuwp_profile_ad_name_last").html(a.last_name),b("#_wsuwp_profile_ad_title").html(a.position_title),b("#_wsuwp_profile_ad_office").html(a.office),b("#_wsuwp_profile_ad_address").html(a.address),b("#_wsuwp_profile_ad_phone").html(a.phone),b("#_wsuwp_profile_ad_email").html(a.email),b("#_wsuwp_profile_alt_office").val(a.office_alt).data("original",a.office_alt),b("#_wsuwp_profile_alt_phone").val(a.phone_alt).data("original",a.phone_alt),b("#_wsuwp_profile_alt_email").val(a.email_alt).data("original",a.email_alt),b("#_wsuwp_profile_website").val(a.website).data("original",a.website),window.tinymce.get("content").setContent(a.content.rendered),profile_original_personal_bio=a.content.rendered,j?(j.setContent(a.bio_unit),profile_original_unit_bio=a.bio_unit):b("#bio_unit .readonly").html(a.bio_unit),k?(k.setContent(a.bio_university),profile_original_university_bio=a.bio_university):b("#bio_university .readonly").html(a.bio_university),b.each(a.working_titles,function(a,g){var h=b("[name='_wsuwp_profile_title[]']")[a];h?b(h).val(g):d.before(c({label:e,name:f,value:g}))}),profile_original_titles=a.working_titles,""!==b(".use-title").val()){var l=b(".use-title").val().split(" ");b.each(l,function(a,c){b(".wsuwp-profile-titles p").eq(c).addClass("selected").find(".screen-reader-text").text("Deselect")})}b.each(a.degree,function(a,d){var e=b("[name='_wsuwp_profile_degree[]']")[a];e?b(e).val(d):g.before(c({label:h,name:i,value:d}))}),profile_original_degrees=a.degree,a._embedded&&0!==a._embedded["wp:photos"]&&b.each(a._embedded["wp:photos"],function(a,b){populate_photos(b)}),a._embedded&&a._embedded["wp:featuredmedia"]&&0!==a._embedded["wp:featuredmedia"]&&populate_photos(a._embedded["wp:featuredmedia"][0]),""!==b(".use-photo").val()?b(".wsuwp-profile-photo-wrapper").eq(b(".use-photo").val()).addClass("selected").find(".wsuwp-profile-photo-select").attr("aria-label","Deselect"):b(".wsuwp-profile-photo-wrapper").eq(0).addClass("selected").find(".wsuwp-profile-photo-select").attr("aria-label","Deselect"),a._embedded&&a._embedded["wp:term"]&&0!==a._embedded["wp:term"]&&(b.each(a._embedded["wp:term"],function(a,c){c&&b.each(c,function(a,c){"post_tag"===c.taxonomy?b("#new-tag-post_tag").val(function(a,b){return b+c.name+", "}):b("#"+c.taxonomy+"-all").find(".selectit:contains('"+c.name+"')").find("input[type='checkbox']").prop("checked",!0)})}),b(".tagadd").trigger("click"),b("#title").focus()),b.ajax({url:window.wsuwp_people_edit_profile_secondary.rest_url+"/"+a.id,type:"POST",beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",window.wsuwp_people_edit_profile_secondary.nonce),a.setRequestHeader("X-WSUWP-UID",window.wsuwp_people_edit_profile_secondary.uid)},error:function(){b("#wsuwp_profile_additional_info input").prop("disabled",!0),b(".wsuwp-profile-button.remove").prop("disabled",!0),b("#new-tag-post_tag").prop("disabled",!0),b(".tabs-panel input").prop("disabled",!0),b(".wsuwp-profile-add-photo").prop("disabled",!0),b(".wsuwp-profile-photo-remove").prop("disabled",!0),window.tinymce.get("content").setMode("readonly"),j&&j.setMode("readonly"),k&&k.setMode("readonly")}})}function populate_photos(a){var b=jQuery,c=_.template(b("#photo-template").html()),d=a.media_details,e=d.sizes.thumbnail,f=e?d.sizes.thumbnail.source_url:a.source_url,g=e?d.sizes.thumbnail.width:d.width,h=e?d.sizes.thumbnail.height:d.height;-1===b.inArray(a.id,existing_photos())&&b(".wsuwp-profile-photo-collection").append(c({src:f,width:g,height:h,id:a.id,alt:a.alt,url:a.source_url,title:a.title.rendered,full_width:d.width,full_height:d.height}))}var profile_original_titles,profile_original_degrees,profile_original_personal_bio,profile_original_unit_bio,profile_original_university_bio;!function(a,b,c){a(c).ready(function(){var c=a("#_wsuwp_profile_ad_nid");b.wsuwp_people_edit_profile_secondary.load_data&&a.ajax({url:b.wsuwp_people_edit_profile_secondary.rest_url,data:{_embed:!0,wsu_nid:c.val()}}).done(function(a){0!==a.length&&populate_from_people_directory(a[0])}),a(".wsuwp-profile-about-tabs").on("click",".select",function(){var b=a(this).closest("li"),c=a(".use-bio");b.toggleClass("selected"),b.hasClass("selected")?(c.val(b.data("bio")),b.find(".screen-reader-text").text("Deselect"),b.siblings().removeClass("selected").find(".screen-reader-text").text("Select")):(c.val(""),b.find(".screen-reader-text").text("Select"))}),a(".wsuwp-profile-titles").on("click",".select",function(){var b=a(this).closest("p");b.toggleClass("selected");var c=a(".wsuwp-profile-titles .selected").map(function(){return a(this).index()}).get();a(".use-title").val(c.join(" ")),b.hasClass("selected")?b.find(".screen-reader-text").text("Deselect"):b.find(".screen-reader-text").text("Select")}),a(".wsuwp-profile-photo-collection").on("click",".wsuwp-profile-photo-select",function(){var b=a(this),c=b.closest(".wsuwp-profile-photo-wrapper"),d=a(".use-photo");c.toggleClass("selected").siblings().removeClass("selected"),c.hasClass("selected")?(d.val(a(".wsuwp-profile-photo-wrapper").index(c)),b.attr("aria-label","Deselect"),c.siblings().removeClass("selected").find(".wsuwp-profile-photo-select").attr("aria-label","Select")):(d.val(""),b.attr("aria-label","Select"))}),a("#publish").on("click",function(){var d={},e=a("#title"),f=a("#_wsuwp_profile_alt_office"),g=a("#_wsuwp_profile_alt_phone"),h=a("#_wsuwp_profile_alt_email"),i=a("#_wsuwp_profile_website"),j=a("[name='_wsuwp_profile_title[]']"),k=a("[name='_wsuwp_profile_degree[]']"),l=b.tinymce.get("content"),m=b.tinymce.get("_wsuwp_profile_bio_unit"),n=b.tinymce.get("_wsuwp_profile_bio_university");if(e.val()!==e.data("original")&&(d.title=e.val()),f.val()!==f.data("original")&&(d.office_alt=f.val()),g.val()!==g.data("original")&&(d.phone_alt=g.val()),h.val()!==h.data("original")&&(d.email_alt=h.val()),i.val()!==i.data("original")&&(d.website=i.val()),j){var o=j.map(function(){return a(this).val()}).get();o.join(",")!==profile_original_titles.join(",")&&(d.working_titles=o)}if(k){var p=k.map(function(){return a(this).val()}).get();p.join(",")!==profile_original_degrees.join(",")&&(d.degree=p)}l&&l.getContent()!==profile_original_personal_bio&&(d.content=l.getContent()),m&&m.getContent()!==profile_original_unit_bio&&(d.bio_unit=m.getContent()),n&&n.getContent()!==profile_original_university_bio&&(d.bio_university=n.getContent()),a.isEmptyObject(d)||a.ajax({url:b.wsuwp_people_edit_profile_secondary.rest_url+"/"+c.data("post-id"),method:"POST",beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",b.wsuwp_people_edit_profile_secondary.nonce),a.setRequestHeader("X-WSUWP-UID",b.wsuwp_people_edit_profile_secondary.uid)},data:d})})})}(jQuery,window,document);