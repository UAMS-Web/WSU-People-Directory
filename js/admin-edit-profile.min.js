var wsuwp=wsuwp||{};!function(e,a,t,i){e(t).ready(function(){var t=e("#publishing-action .spinner"),s=e("#_wsuwp_profile_ad_nid"),o=e("#confirm-ad-hash"),n=e("#confirm-ad-data"),r=e(".wsu-person .card"),l=e(".wsu-person-add-repeatable-meta"),d=_.template(e(".wsu-person-repeatable-meta-template").html());e("#load-ad-data").on("click",function(r){if(r.preventDefault(),r.target.disabled=!0,""!==s.val()){t.css("visibility","visible");var l={action:"wsu_people_get_data_by_nid",_ajax_nonce:a.wsuwp_people_edit_profile.nid_nonce,network_id:s.val(),request_from:a.wsuwp_people_edit_profile.request_from,is_refresh:e(r.target).is("#refresh-ad-data")?"true":"false"};e.post(a.ajaxurl,l,function(l){r.target.disabled=!1,t.css("visibility","hidden"),l.success?(l.data.id?i.people.populate_person_from_people_directory(l.data):(e(".wsu-person").attr("data-nid",s.val()),e(".wsu-person .name").text(l.data.given_name+" "+l.data.surname),e("[name='post_title']").val(l.data.given_name+" "+l.data.surname),e(".wsu-person .title").text(l.data.title),e("[name='_wsuwp_profile_title[]']").val(l.data.title),e(".wsu-person .email").text(l.data.email),e("[name='_wsuwp_profile_alt_email']").val(l.data.email),e(".wsu-person .phone").text(l.data.telephone_number),e("[name='_wsuwp_profile_alt_phone']").val(l.data.telephone_number),e(".wsu-person .office").text(l.data.office),e("[name='_wsuwp_profile_alt_office']").val(l.data.office),e(".wsu-person .address").text(l.data.street_address),e("[name='_wsuwp_profile_alt_address']").val(l.data.street_address),o.val(l.data.confirm_ad_hash)),n.removeClass("profile-hide-button")):a.alert(l.data)})}else a.alert("Please enter a Network ID")}),n.on("click",function(i){i.preventDefault(),i.target.disabled=!0,t.css("visibility","visible"),e("#load-ad-data").addClass("profile-hide-button");var r={action:"wsu_people_confirm_nid_data",_ajax_nonce:a.wsuwp_people_edit_profile.nid_nonce,network_id:s.val(),confirm_ad_hash:o.val(),post_id:e("#post_ID").val(),request_from:a.wsuwp_people_edit_profile.request_from},l=e(".load-ad-container .description"),d=e("#publish");e.post(a.ajaxurl,r,function(a){a.success&&(s.attr("readonly",!0),l.html("The WSU Network ID used to populate this profile's data from "+l.data("location")+"."),e(".spinner").css("visibility","hidden"),n.addClass("profile-hide-button"),d.removeClass("profile-hide-button"))})}),r.on("focusout","[contenteditable='true']",function(){var a=e(this).attr("class"),t=e(this).index("."+a),i=e(this).text();e("[data-for='"+a+"']").eq(t).val(i)}),r.on("keypress","[contenteditable='true']",function(e){13===e.which&&e.preventDefault()}),l.click(function(){e(this).before(d({type:e(this).data("type"),value:""}))}),r.on("click",".wsu-person-remove",function(){e(this).closest("div").remove()})})}(jQuery,window,document,wsuwp);