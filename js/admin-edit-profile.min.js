var wsuwp=wsuwp||{};!function(e,t,a,i){e(a).ready(function(){var a=e("#publishing-action .spinner"),n=e("#_wsuwp_profile_ad_nid"),s=e("#confirm-ad-hash"),o=e("#confirm-ad-data"),r=e(".wsu-person-card"),d=e(".wsu-person-add-repeatable-meta"),l=_.template(e(".wsu-person-repeatable-meta-template").html());e("#load-ad-data").on("click",function(r){if(r.preventDefault(),r.target.disabled=!0,""!==n.val()){a.css("visibility","visible");var d={action:"wsu_people_get_data_by_nid",_ajax_nonce:t.wsuwp_people_edit_profile.nid_nonce,network_id:n.val(),request_from:t.wsuwp_people_edit_profile.request_from,is_refresh:e(r.target).is("#refresh-ad-data")?"true":"false"};e.post(t.ajaxurl,d,function(d){r.target.disabled=!1,a.css("visibility","hidden"),d.success?(d.data.id?i.people.populate_person_from_people_directory(d.data):(e(".wsu-person").attr("data-nid",n.val()),e(".wsu-person-name").text(d.data.given_name+" "+d.data.surname).next("input").val(d.data.given_name+" "+d.data.surname),e(".wsu-person-title [contenteditable='true']").text(d.data.title).next("input").val(d.data.title),e(".wsu-person-email").text(d.data.email).next("input").val(d.data.email),e(".wsu-person-phone").text(d.data.telephone_number).next("input").val(d.data.telephone_number),e(".wsu-person-office").text(d.data.office).next("input").val(d.data.office),e(".wsu-person-address").text(d.data.street_address).next("input").val(d.data.street_address),s.val(d.data.confirm_ad_hash)),o.removeClass("profile-hide-button")):t.alert(d.data)})}else t.alert("Please enter a Network ID")}),o.on("click",function(i){i.preventDefault(),i.target.disabled=!0,a.css("visibility","visible"),e("#load-ad-data").addClass("profile-hide-button");var r={action:"wsu_people_confirm_nid_data",_ajax_nonce:t.wsuwp_people_edit_profile.nid_nonce,network_id:n.val(),confirm_ad_hash:s.val(),post_id:e("#post_ID").val(),request_from:t.wsuwp_people_edit_profile.request_from},d=e(".load-ad-container .description"),l=e("#publish");e.post(t.ajaxurl,r,function(t){t.success&&(n.attr("readonly",!0),d.html("The WSU Network ID used to populate this profile's data from "+d.data("location")+"."),e(".spinner").css("visibility","hidden"),o.addClass("profile-hide-button"),l.removeClass("profile-hide-button"))})}),r.on("focusout","[contenteditable='true']",function(){e(this).next("input").val(e(this).text())}),r.on("keypress","[contenteditable='true']",function(e){13===e.which&&e.preventDefault()}),d.click(function(){e(this).before(l({type:e(this).data("type"),value:""}))}),r.on("click",".wsu-person-remove",function(){e(this).closest("div").remove()})})}(jQuery,window,document,wsuwp);